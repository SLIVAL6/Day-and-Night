<html>

<head>
  <title>Computer Graphics Assessment 4</title>
</head>

<style>
  body {
    margin: 0;
  }

  canvas {
    width: 100%;
    height: 100%;
  }
</style>

<body>
  <link rel = "shortcut icon" href = "#">

  <style>
    body {
      font-family: Monospace;
      background-color: #000;
      color: #fff;
      margin: 0px;
      overflow: hidden;
    }

    #info {
      position: absolute;
      top: 10px;
      width: 100%;
      text-align: left;
    }
  </style>

  <div id = "info">
    <p>
      Computer Graphics - Assessment 4<br>
      Megan<br>
    </p>
  </div>

  <script type = "importmap">
			{
				"imports": {
					"three": "./build/three.module.js"
				}
			}
	</script>

  <script type = "module">

    import * as THREE from 'three';
    import { OrbitControls } from './build/OrbitControls.js';
    import { Sky } from './build/Sky.js';

    // Create scene
    var scene = new THREE.Scene();
    var ratio = window.innerWidth / window.innerHeight;
    //scene.background = new THREE.Color("rgb(0, 0, 0)");
    //scene.background = new THREE.Color("rgb(135, 206, 250)"); 

    // Camera setup
    var camera = new THREE.PerspectiveCamera(45, ratio, 0.1, 1000);
    camera.position.set(0, 0, 15);
    camera.lookAt(0, 0, 1);

    // Renderer setup
    var renderer = new THREE.WebGLRenderer();
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);

    // Random Location Generator
    function randomLocation(){
      var num = Math.floor(Math.random() * 50) + 1;
      num *= Math.floor(Math.random() * 2) == 1 ? 1 : -1;
      return num;
    }
   
    // Star Generation
    var stars = [];

    for(let i = 0; i < 1000; i++){
      let star_geometry = new THREE.BoxGeometry(0.07, 0.07, 0.07);
      let star_material = new THREE.MeshBasicMaterial({color: 0xffffff});
      let star = new THREE.Mesh(star_geometry, star_material);
      star.position.set(randomLocation(), randomLocation(), randomLocation());
      stars.push(star);
    }

    for(let i = 0; i < stars.length; i++){
      scene.add(stars[i]);
    }

    var star_lightness = 0;

    function animate(){
      for(let i = 0; i < stars.length; i++){
        let star = stars[i];
        star.rotation.x += 0.01;
        star.rotation.y += 0.01;
      }
      
      requestAnimationFrame(animate);
      renderer.render(scene, camera);
    }
    animate();

    // Clears the scene when parameters are updated
    function ClearScene() {
      for (let i = scene.children.length - 1; i >= 0; i--) {
        if (scene.children[i].type == "Mesh") {
          scene.remove(scene.children[i]);
        }
      }
    }

    // Frame information
    var FrameMatrix = [];
    var subFrames = 10;
    var currFrame = 0;

    // Creates Scene
    function CreateScene() {
    }

    CreateScene();

    const maxTime = 1440; // Amount of minutes in a day (24 hrs * 60 mins)
    var time = 1440; // Value between 0 and 1440 in minutes
    var currentTime; // Value between 0 and 1 to represent current time of day
    var timePaused = false; // Pauses time
    var minutes = 1; // Rate at which time passes; set to negative to reverse time
    function ProcessTime() {
      // Adds minutes to time each update frame
      if(!timePaused)
      {
        time += minutes;
      }

      // Resets time to 0 when it exceeds 1440
      if(time >= maxTime)
      {
        time = 0;
      }

      // Sets current time
      currentTime = time / maxTime;

      if(currentTime < 720){
        scene.background = new THREE.Color("rgb(135, 206, 250)"); 
      }
      if(currentTime >= 720){
        scene.background = new THREE.Color("rgb(0, 0, 0)");
      }
    }

    // Directly sets the value of time
    function SetTime(newTime) {
      time = newTime;
    }

    var controls = new OrbitControls(camera, renderer.domElement);

    // Final update loop
    var MyUpdateLoop = function () {
      renderer.render(scene, camera);
      controls.update();

      ProcessTime();

      requestAnimationFrame(MyUpdateLoop);
    };

    requestAnimationFrame(MyUpdateLoop);

    function handleKeyDown(event) {
    }

  window.addEventListener('keydown', handleKeyDown, false);

    // Called when the window is resized
    var MyResize = function () {
      var width = window.innerWidth;
      var height = window.innerHeight;
      renderer.setSize(width, height);
      camera.aspect = width / height;
      camera.updateProjectionMatrix();
      renderer.render(scene, camera);
    };

    // Link the resize of the window to the camera update
    window.addEventListener('resize', MyResize);
  </script>
</body>

</html>