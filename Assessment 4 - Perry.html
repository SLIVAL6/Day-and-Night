<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Cloud Generation with Three.js</title>
  <style>
    body { margin: 0; }
    canvas { display: block; }
  </style>
</head>
<body>
<script type = "importmap">
    {
      "imports": {
        "three": "./build/three.module.js"
      }
    }
</script>

<script type = "module">
  
    import * as THREE from 'three';
    import { OrbitControls } from './build/OrbitControls.js';

    var time = 0;
    var clouds = []; 

    // Set up the scene
    var scene = new THREE.Scene();
    var camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
    camera.position.x = -150;
    camera.position.z = 110;

    // Create a renderer
    var renderer = new THREE.WebGLRenderer();
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);

    var controls = new OrbitControls(camera, renderer.domElement);

    // Add lighting
    var ambientLight = new THREE.AmbientLight(0xffffff, 1);
    scene.add(ambientLight);

    // Create cloud geometry
    var cloudGeometry = new THREE.SphereGeometry(1, 100, 100);

    // Create cloud material
    var cloudMaterial = new THREE.MeshPhongMaterial({
      color: 0xffffff,
      opacity: 1,
      transparent: true,
      depthWrite: false
    });

    // Create multiple cloud meshes
    for (var i = 0; i < 500; i++) {
      if (time % 2 == 0) {
        clouds[i] = new THREE.Mesh(cloudGeometry, cloudMaterial);
        clouds[i].position.x = Math.random() * randomNumber(-60, 39) - 5;
        clouds[i].position.y = Math.random() * randomNumber(-58, 35) - 5;
        clouds[i].position.z = Math.random() * randomNumber(-44, 40) - 5;
        clouds[i].scale.setScalar(Math.random() * 12 + 0.5);
        scene.add(clouds[i]);
      } else {
        clouds[i] = new THREE.Mesh(cloudGeometry, cloudMaterial);
        clouds[i].position.x = Math.random() * 50 - 5;
        clouds[i].position.y = Math.random() * 50 - 5;
        clouds[i].position.z = Math.random() * 50 - 5;
        clouds[i].scale.setScalar(Math.random() * 2 + 0.5);
        scene.add(clouds[i]);
      }
    }

    // Animation loop
    function animate() {
      time++;

      if (time >= 720) {
        if (time % 1000 == 0) {
          for (var i = 0; i < 500; i++) {
            clouds[i].scale.setScalar(clouds[i].scale * 0.5);
            scene.add(clouds[i]);
          }
        }
      }

      requestAnimationFrame(animate);

      // Rotate the clouds
      scene.traverse(function (object) {
        if (object instanceof THREE.Mesh) {
          object.rotation.x += 0.005;
          object.rotation.y += 0.005;
        }
      });

      // Render the scene
      renderer.render(scene, camera);
    }

    function randomNumber(min, max) {
      return Math.random() * (max - min) + min;
    }

    // Start the animation
    animate();
  </script>
</body>
</html>
